{% extends 'base.html.twig' %}
{% block title %}Internal Incident Form{% endblock %}
{% block stylesheets %}
    <style>
        table#t01 {
            width: 50%;
            text-align: center;
        }
        table, th, td {
            border: 1px solid black;
        }
    </style>
{% endblock %}

{% block body %}
    <h3>Internal Incident Report</h3>
    <form action="#" method="post">
        <table id="t01">
            <tr>
                <td>
                    Date of Incident:
                    <input type="date" name="incidentdate">
                </td>
                <td>
                    Time of Incident:
                    <input type="time" name="incidenttime">
                </td>
                <td>
                    Patient Name:
                    <input type="text" name="firstname">
                </td>
                <td>
                    Location of Incident:
                    <input type="text" name="location">
                </td>
            </tr>
            <tr>
                <td>
                    Supervisor Notified:
                    <input type="text" name="supervisor">
                </td>
                <td>
                    Staff Name:
                    <input type="text" name="staff">
                </td>
                <td>
                    Date:
                    <input type="date" name="date">
                </td>
                <td>
                    Time:
                    <input type="time" name="time">
                </td>
            </tr>
        </table>
        <br>
        <table id="t01">
            <caption><b>Type of Incident:</b>(Please select from drop down list under correct section)</caption>
            <tr>
                <td>
                    Injury
                    <input list="injury">
                    <datalist id="injury">
                        <option value="Patient">
                        <option value="Staff">
                        <option value="Visitor">
                    </datalist>
                </td>
                <td>
                    Damage
                    <input list="damage">
                    <datalist id="damage">
                        <option value="DeRiche Property">
                        <option value="Personal Property">
                        <option value="Vehicle">
                        <option value="Other">
                    </datalist>
                </td>
                <td>
                    Infectious / Contagious Disease
                    <input type="checkbox" name="disease" value="disease">
                </td>
                <td>
                    Medication Issue
                    <input list="medication">
                    <datalist id="medication">
                        <option value="Error">
                        <option value="Adverse Drug Reaction">
                        <option value="Food / Drug Interaction">
                        <option value="Property Loss">
                        <option value="Patient Absence">
                        <option value="Other">
                    </datalist>
                </td>
            </tr>
        </table>
        <p>If "Other" in any section, please describe below:</p>
        <textarea name="other" rows="2" cols="50"></textarea><br>
        <h3>Classification of Incident (Check any that apply)</h3>
        <input type="checkbox" name="sib" value="SIB">SIB<br>
        <input type="checkbox" name="attention" value="Attention Seeking">Attention Seeking<br>
        <input type="checkbox" name="security" value="Security">Security<br>
        <input type="checkbox" name="other2" value="Other">Other<br>
        <input type="checkbox" name="minor" value="Minor">Minor<br>
        <input type="checkbox" name="mild" value="Mild">Mild<br>
        <input type="checkbox" name="moderate" value="Moderate">Moderate<br>
        <input type="checkbox" name="major" value="Major">Major<br>
        <h3>Location of Injury</h3>
        <p>Mark on the figures the general area of any cuts, scratches, marks or bruises possibly relating to the incident/accident.</p>
        <canvas id="intinc" width="545" height="481" style="margin-top: 10px;"></canvas>
        <br/><button href="#" onclick='intclear()'>Clear</button>
        <p style="margin-top: 8px;">Other Person(s) Involved Participant, Staff, Visitor, please use first name or initials only:</p>
        <textarea name="otherinvolved" rows="2" cols="50"></textarea><br><br>
        <h3>Description of Incident</h3>
        <p>Was anyone injured? Was first aid needed? Who? Describe.</p>
        <textarea name="anyone" rows="2" cols="50"></textarea><br>
        <p>What happened before the incident took place?</p>
        <textarea name="before" rows="2" cols="50"></textarea><br>
        <p>What happened during the incident?</p>
        <textarea name="during" rows="2" cols="50"></textarea><br>
        <p>What happened right after the incident?</p>
        <textarea name="after" rows="2" cols="50"></textarea><br>
        <p>Why did the incident occur?</p>
        <textarea name="why" rows="2" cols="50"></textarea><br>
        <p>What did you do?</p>
        <textarea name="what" rows="2" cols="50"></textarea><br>

        <p>**Report must be completed by employee within 24 hours of incident. If incident involves more than one participant, fill out separate report for each.**</p>
        <p>Name of person completing this Incident/Accident Form & Date:</p>
        <input type="text" name="person" placeholder="Name"> <input type="date" name="date1">
        <br>
        <h3>Review: Recommendations for Follow-Up (Admin Only)</h3>
        <textarea name="recommend" rows="4" cols="50"></textarea><br>
        <p>Printed Name Person Reviewing Report:</p>
        <input type="text" name="reviewing">

        <canvas id="signature" width="710" height="149" style="margin-top: 5px; border:2px solid;"></canvas>
        <input type="button" value="Clear Signature" style="top:180px; background:white; border:2px solid;" onclick="Sclear()">

        <input type="submit" onClick="save()" value="Submit"/>  <input type="reset" value="Clear"/>
        <input type="hidden" name="intData" id="intData" value="">
        <input type="hidden" name="sigData" id="sigData" value=""><br><br>

    </form><br>
    <button onclick="myFunction()">Help</button>
{% endblock %}

{% block javascripts %}
    <script src="{{ asset('jquery.jqscribble.js') }}"></script>
    <script>
        $(document).ready(function () {
            $("#intinc").jqScribble();
            $("#intinc").data("jqScribble").update({backgroundImage: "{{  asset('internal.png') }}"});
            // Need to edit jqscribble to fix this issue. TODO: Troubleshoot and remove the timeout.
            setTimeout(function () {
                $("#signature").jqScribble();
                $("#signature").data("jqScribble").update({backgroundImage: "{{  asset('sigImg.png') }}"});
            }, 10);
        });

        function intclear() {
            $("#intinc").data("jqScribble").clear();
            $("#intinc").data("jqScribble").update({backgroundImage: "{{  asset('internal.png') }}"});
        }

        function Sclear() {
            $("#signature").data("jqScribble").clear();
            $("#signature").data("jqScribble").update({backgroundImage: "{{  asset('sigImg.png') }}"});
        }

        //  This is the actual way to save the canvas (base64) - can save this to a variable and POST it.
        //  var bodycanv = document.getElementById('bodycheck');
        //  console.log(bodycanv.toDataURL())

        // TODO: Replace this.
        function myFunction() {
            alert(
                "1.Enter Participant?s name in the field provided (First name and last name)\n2.Enter Date and Time of Incident in the fields provided (Date of Incident and Time of Incident)\n3.Enter Location of Incident in the field provided\n4.Enter name of supervisor that was notified in the field provided\n5.Enter your name in the field provided (Staff Name)\n6.Enter date and time in the fields provided (Date and Time)\n7.If someone was injured, select the type of person injured in the drop-down provided (Click-box under Injury)\n8.If damage occurred, select the type of damaged in the drop-down provided (Click-box under Damage)\n9.If an infectious/contagious disease was involved, check the box in the space provided (Check-box under Infectious/Contagious Disease)\n10.If there was a medication issue, select the type of issue in the drop-down provided (Click-box under Medication Issue)\n11.If ?Other? was selected in any of the previous drop-down lists, please specify (Other)\n12.Mark on the chart below any location of injuries\n13.If more than one person was involved, please specify first name of person (initials will also work)\n14.If anyone was injured, please specify what kind of first aid, who was aided, and whether or not first aid was needed, and what was done after the incident\n15.What happened before the incident took place\n16.What happened during the incident\n17.What happened after the incident took place\n18.Why did the incident occur\n19.What did you do\n20.Type your name in the field provided (Under name of person completing form)\n21.Select the date in the from the date picker provided (Under name of person completing form)\n22.In the Recommendations for follow up section,  only if Admin, please type in any recommendations you have for the participant\n23.Enter the name of the reviewer in the field provided\n24.Sign the signature box with the mouse\n25.Click the submit button to finish\n");
        }
    </script>
    {#<script src="{{ asset('internal_incident.js') }}"></script>#}
{% endblock %}